<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!--=============== BOXICONS ===============-->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">

        <!-- =============== CSS =============== -->
        <link rel="stylesheet" href="index.css">
        <link rel="stylesheet" href="styles.css">

        <title>Token Gen</title>
    <script src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs" type="module"></script>

</head>
<body>

<!--=============== HEADER ===============-->
<header class="header" id="header">
    <nav class="nav container">
        <a href="#" class="nav__logo"> Token Gen</a>

        <div class="nav__menu" id="nav-menu">
            <ul class="nav__list">
                <li class="nav__item">
                    <a href="token.html" class="nav__link">Home</a>
                </li>
                <li class="nav__item">
                    <a href="token.html#about" class="nav__link">Check Queue</a>
                </li>
                <li class="nav__item">
                    <a href="token.html#generate" class="nav__link active-link">Generate</a>
                </li>
                <li class="nav__item">
                    <a href="token.html#contact" class="nav__link">Contact us</a>
                </li>

            </ul>
        </div>

        <div class="nav__toggle" id="nav-toggle">
            <i class='bx bx-grid-alt'></i>
        </div>

        <a href="login.html" class="button button__header">Profile</a>
    </nav>
</header><br><br>
    <!--=============== application =========-->
    
  
 <div class="container-a">
        <h1 class="appli">Application Form</h1>
        <form id="myForm" action="genform.php" method="post">
            <div class="form-group">
                <label for="application-number">Application Number</label>
                <input type="text" id="application-number" name="application-number" required>
            </div>
            <div class="form-group">
                <label class="appli-l" for="department">Department</label>
                <select id="department" name="department" required>
                    <option value="" disabled selected>Select Department</option>
                    <option value="enquiry">enquiry</option>
                    <option value="fees">fees</option>
                    <option value="interview">interview</option>
                    <option value="other">other</option>
                </select>
            </div>
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <button id="enqueue-button" onclick="enqueue()"class="show-modal" type="submit">Generate</button>
            </div>
        </form>
    </div>
    <script src="queue.js">
      
    </script>
        <!--=============== SCROLL UP ===============-->
        <a href="#" class="scrollup" id="scroll-up">
            <i class='bx bx-up-arrow-alt scrollup__icon'></i>
        </a>

        <!--=============== MAIN JS ===============-->
        <script src="script.js"></script>
        <script>  function enqueue() {
            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    updateWaitingList();
                    updateTokenNumber();
                    
                }
            };
            xhr.open("GET", "enqueue.php", true);
            xhr.send();
            
        }

            function updateWaitingList() {
            const waitingListElement = document.getElementById("waiting-list");
            waitingListElement.innerHTML = '';
            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    const waitingList = JSON.parse(xhr.responseText);
                    for (let i = 0; i < waitingList.length; i++) {
                        const listItem = document.createElement("li");
                        listItem.textContent = waitingList[i];
                        waitingListElement.appendChild(listItem);
                    }
                }
            };
            xhr.open("GET", "get_waiting_list.php", true);
            xhr.send();
        }
        </script>
        
    </body>
</html>